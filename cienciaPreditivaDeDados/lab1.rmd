---
title: 'AnÃ¡lise de Gastos de Deputados: Nossas Perguntas'
output: html_document
---

```{r}
library(readr)
library(dplyr)
library(ggplot2)
library(knitr)
```

Algum texto legal aqui

```{r}
dadosCEAP <- read_csv("data/dadosCEAP.csv")
View(dadosCEAP)

limiteMensalCEAP <- read_csv("data/limiteMensalCEAP.csv")
View(limiteMensalCEAP)
```


```{r}
dadosCEAP$valorGlosa <- as.numeric(sub(",", ".", dadosCEAP$valorGlosa, fixed = TRUE)) 
```

1 - Quais são os deputados que gastaram mais dinheiro da CEAP? Quais são os mais econômicos? .

```{r}
gastos = dadosCEAP %>% select(nomeParlamentar,valorLíquido)%>%
  group_by(nomeParlamentar)%>%
  summarise( gastosTotal = sum(valorLíquido))

#gastos= gastos[order(gastos$gastosTotal),c(2,1)]

maisGastos = gastos %>% top_n(10)
#
maisGastos$nomeParlamentar = factor(maisGastos$nomeParlamentar, levels = maisGastos$nomeParlamentar[order(maisGastos$nomeParlamentar)])
#menosGastos = gastos %>% top_n(-10)
#menosGastos= menosGastos[order(menosGastos$gastosTotal),c(2,1)]

maisGastos %>% 
  ggplot(aes(x=nomeParlamentar,y = gastosTotal))+
  theme_bw()+
  geom_bar(stat='identity')+
  labs(title="Deputados que mais gastaram",y="Valor",x="Nome Deputado")+
  
  coord_flip()


```
```{r}
menosGastos = gastos %>% top_n(-10)
#
menosGastos$nomeParlamentar = factor(menosGastos$nomeParlamentar, levels = menosGastos$nomeParlamentar[order(menosGastos$nomeParlamentar)])
#menosGastos = gastos %>% top_n(-10)
#menosGastos= menosGastos[order(menosGastos$gastosTotal),c(2,1)]

menosGastos %>% 
  ggplot(aes(x=nomeParlamentar,y = gastosTotal))+
  theme_bw()+
  geom_bar(stat='identity')+
  labs(title="Deputados que menos gastaram",y="Valor",x="Nome Deputado")+
  
  coord_flip()
```


2 - Quais os estados cujos deputados gastam mais no exterior? Quais os estados cujos deputados gastam menos no exterior? 

```{r}
#como saber se o gasto foi no exterior? tipoDocumento==2
gastos2 = dadosCEAP %>% select (sgUF,valorLíquido,tipoDocumento)%>%
  filter(tipoDocumento==2)%>%
  group_by(sgUF)%>%
  summarise( gastosTotal = sum (valorLíquido))

maisGastos = gastos2 %>% top_n(10)
maisGastos$sgUF = factor(maisGastos$sgUF, levels = maisGastos$sgUF[order(maisGastos$sgUF)])

maisGastos %>% 
  ggplot(aes(x=sgUF,y = gastosTotal))+
  theme_bw()+
  geom_bar(stat='identity')+
  labs(title="Deputados que mais gastaram no exterior",y="Valor",x="Estado do Deputado")+
  
  coord_flip()

```
```{r}
menosGastos = gastos2 %>% top_n(-10)
menosGastos$sgUF = factor(menosGastos$sgUF, levels = menosGastos$sgUF[order(menosGastos$sgUF)])

menosGastos %>% 
  ggplot(aes(x=sgUF,y = gastosTotal))+
  theme_bw()+
  geom_bar(stat='identity')+
  labs(title="Deputados que menos gastaram no exterior",y="Valor",x="Estado do Deputado")+
  
  coord_flip()
```



3 - Quais os partidos cujos parlamentares mais usam CEAP no estado da Paraíba? Quais são os que menos usam? Mesmas perguntas considerando valores em R$.

```{r}
gastos3 = dadosCEAP %>% select(sgPartido, sgUF ,valorLíquido ) %>%
  filter(sgUF=='PB')%>%
  group_by(sgPartido)%>%
  summarise( gastosTotal = sum(valorLíquido))

maisGastos = gastos3 %>% top_n(5)
maisGastos$sgPartido = factor(maisGastos$sgPartido, levels = maisGastos$sgPartido[order(maisGastos$sgPartido)])

maisGastos %>% 
  ggplot(aes(x=sgPartido,y = gastosTotal))+
  theme_bw()+
  geom_bar(stat='identity')+
  labs(title="Partidos que mais gastam da Paraiba",y="Valor",x="Partido ")+
  
  coord_flip()
  
```

```{r}
menosGastos = gastos3 %>% top_n(-5)
menosGastos$sgPartido = factor(menosGastos$sgPartido, levels = menosGastos$sgPartido[order(menosGastos$sgPartido)])

menosGastos %>% 
  ggplot(aes(x=sgPartido,y = gastosTotal))+
  theme_bw()+
  geom_bar(stat='identity')+
  labs(title="Partidos que menos gastam da Paraiba",y="Valor",x="Partido")+
  
  coord_flip()
```


4 - Quais os deputados que mais ultrapassam o limite de CEAP do seu estado? 

```{r}


```

5 - Quais estados cujos parlamentares gastam mais com passagens aéreas?
```{r}

```

6 - Escolha três partidos e responda: Quais são os tipos de despesa mais utilizados no uso da CEAP pelos deputados desses partidos? Mesma pergunta considerando valores em R$.
```{r}

```

