---
title: "Regressao"
output: html_document
---

<<<<<<< HEAD
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(readr)

eleicoes_2006 <- read_csv("data/eleicoes_2006.csv")
#View(eleicoes_2006)

eleicoes_2010 <- read_csv("data/eleicoes_2010.csv")
#View(eleicoes_2010)

eleicoes_2006_e_2010 <- read_csv("data/eleicoes_2006_e_2010.csv")
#View(eleicoes_2006_e_2010)

=======
```{r}
library(readr)
library(dplyr)
library(ggplot2)
library(knitr)
library(openintro)
library(tidyverse)
theme_set(theme_bw())
library(modelr)
library(broom)

#install.packages( "readr","dplyr","ggplot2","knitr", "openintro","tidyverse","modelr","broom")
```


```{r}
eleicoes_2006_e_2010 <- readr::read_csv(
  here::here('cienciaPreditivaDeDados/Regressao/data/eleicoes_2006_e_2010.csv'), 
  local=readr::locale("br"),
  col_types = cols(
    ano = col_integer(),
    sequencial_candidato = col_character(),
    quantidade_doacoes = col_integer(),
    quantidade_doadores = col_integer(),
    total_receita = col_double(),
    media_receita = col_double(),
    recursos_de_outros_candidatos.comites = col_double(),
    recursos_de_pessoas_fisicas = col_double(),
    recursos_de_pessoas_juridicas = col_double(),
    recursos_proprios = col_double(),
    `recursos_de_partido_politico` = col_double(),
    quantidade_despesas = col_integer(),
    quantidade_fornecedores = col_integer(),
    total_despesa = col_double(),
    media_despesa = col_double(),
    votos = col_integer(),
    .default = col_character()))

eleicoes_2006 <- readr::read_csv(
  here::here('cienciaPreditivaDeDados/Regressao/data/eleicoes_2006.csv'), 
  local=readr::locale("br"),
  col_types = cols(
    ano = col_integer(),
    sequencial_candidato = col_character(),
    quantidade_doacoes = col_integer(),
    quantidade_doadores = col_integer(),
    total_receita = col_double(),
    media_receita = col_double(),
    recursos_de_outros_candidatos.comites = col_double(),
    recursos_de_pessoas_fisicas = col_double(),
    recursos_de_pessoas_juridicas = col_double(),
    recursos_proprios = col_double(),
    `recursos_de_partido_politico` = col_double(),
    quantidade_despesas = col_integer(),
    quantidade_fornecedores = col_integer(),
    total_despesa = col_double(),
    media_despesa = col_double(),
    votos = col_integer(),
    .default = col_character()))

eleicoes_2010 <- readr::read_csv(
  here::here('cienciaPreditivaDeDados/Regressao/data/eleicoes_2010.csv'), 
  local=readr::locale("br"),
  col_types = cols(
    ano = col_integer(),
    sequencial_candidato = col_character(),
    quantidade_doacoes = col_integer(),
    quantidade_doadores = col_integer(),
    total_receita = col_double(),
    media_receita = col_double(),
    recursos_de_outros_candidatos.comites = col_double(),
    recursos_de_pessoas_fisicas = col_double(),
    recursos_de_pessoas_juridicas = col_double(),
    recursos_proprios = col_double(),
    `recursos_de_partido_politico` = col_double(),
    quantidade_despesas = col_integer(),
    quantidade_fornecedores = col_integer(),
    total_despesa = col_double(),
    media_despesa = col_double(),
    votos = col_integer(),
    .default = col_character()))
>>>>>>> c6d6d23ce47f5f4d25bee6f97ee7563eba4261be
```




1 - Um modelo de regressão múltipla com todas as variáveis é plausível para explicar a variação em y (número de votos) em 2006? Mesma pergunta para 2010. 

Vamos ver primeiro os dados para 2006:

```{r}
mod <- lm(votos ~ total_receita, data = eleicoes_2006)
# sintaxe base R:
summary(mod)
confint(mod)

# broom, que acho mais recomendável: 
tidy(mod, conf.int = TRUE)
glance(mod) # depois falaremos desse

eleicoes_2006 %>% 
  add_predictions(model = mod) %>% # add o que o modelo estima p cada hs_grad
  ggplot(mapping = aes(x = total_receita, y = votos)) + 
  geom_point(alpha = 0.4, size = .5) + 
  geom_line(aes(y = pred), colour = "red")  + 
  geom_abline(intercept = 69, slope = -.65, color  = "darkblue") 
```


```{r}
eleicoes_2006 %>% 
  add_residuals(model = mod) %>% 
  ggplot(aes(total_receita, votos)) + 
  geom_point(alpha = .4) + 
  geom_hline(yintercept = 0, colour = "blue")
```







2 Compare as regressões construídas para 2006 e 2010. Quais as diferenças/semelhanças percebidas? Algumas sugestões:
2.1 Analise os plots de resíduos e verifique se há tendências nos erros para cada ano.
2.2 Quais variáveis conseguem explicar melhor o número de votos? Compare essas variáveis entre os modelos. Mesma coisa para as variáveis menos explicativas.
2.3 Compare os valores de R2 e RSE considerando as regressões para cada ano.
2.4 Inclua outros pontos de comparação que você ache interessante.

3 Todas as variáveis são úteis para os modelos de regressão? Há variáveis redudantes? Faça análises para 2006 e 2010 separadamente. 

4 No caso de haver variáveis pouco explicativas e/ou redudantes, construa um novo modelo sem essas variáveis e o compare ao modelo com todas as variáveis (e.g. em termos de R2 e RSE). Faça isso para 2006 e 2010 separadamente. 

5 Construa agora uma regressão considerando os anos 2006 e 2010 em conjunto. Que diferenças/semelhanças você percebe em relação aos modelos individuais por ano? Veja a questão 2 para sugestões que você usar para comparação.